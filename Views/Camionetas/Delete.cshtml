@model SistemaMantencion.Models.Camioneta

@{
    ViewData["Title"] = "Eliminar Camioneta";
    var puedeEliminar = Model.Estado == "Disponible";
}

<h1>ğŸ—‘ï¸ Desactivar Camioneta</h1>

@if (!puedeEliminar)
{
    <div class="alert alert-danger">
        <h4>âŒ No se puede desactivar esta camioneta</h4>
        <p><strong>Motivo:</strong> La camioneta estÃ¡ actualmente en estado <strong>"@Model.Estado"</strong>.</p>
        <p>Debes cambiar su estado a <strong>"Disponible"</strong> antes de poder desactivarla.</p>
    </div>
}
else
{
    <div class="alert alert-warning">
        <h4>âš ï¸ Â¿EstÃ¡ seguro que desea desactivar esta camioneta?</h4>
        <p><strong>Nota:</strong> La camioneta no serÃ¡ eliminada permanentemente, solo se ocultarÃ¡ de la lista principal.</p>
        <p>PodrÃ¡s restaurarla mÃ¡s tarde si es necesario.</p>
    </div>
}

<div class="card">
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3">Patente:</dt>
            <dd class="col-sm-9"><strong>@Model.Patente</strong></dd>
            
            <dt class="col-sm-3">Marca/Modelo:</dt>
            <dd class="col-sm-9">@Model.Marca @Model.Modelo</dd>
            
            <dt class="col-sm-3">AÃ±o:</dt>
            <dd class="col-sm-9">@Model.Anio</dd>
            
            <dt class="col-sm-3">Kilometraje:</dt>
            <dd class="col-sm-9">@Model.Kilometraje.ToString("N0") km</dd>
            
            <dt class="col-sm-3">Estado:</dt>
            <dd class="col-sm-9">
                @if (Model.Estado == "Disponible")
                {
                    <span class="badge bg-success">@Model.Estado</span>
                }
                else if (Model.Estado == "EnArriendo")
                {
                    <span class="badge bg-warning text-dark">En Arriendo</span>
                }
                else
                {
                    <span class="badge bg-danger">En MantenciÃ³n</span>
                }
            </dd>
            
            <dt class="col-sm-3">Fecha Registro:</dt>
            <dd class="col-sm-9">@Model.FechaRegistro.ToString("dd/MM/yyyy")</dd>
        </dl>
        
        @if (!puedeEliminar)
        {
            <div class="alert alert-info">
                <h6>ğŸ“ Â¿QuÃ© hacer?</h6>
                <ol class="mb-0">
                    @if (Model.Estado == "EnArriendo")
                    {
                        <li>Finaliza el arriendo activo desde el <strong>Sistema Comercial</strong></li>
                        <li>La camioneta volverÃ¡ automÃ¡ticamente a estado "Disponible"</li>
                        <li>Luego podrÃ¡s eliminarla</li>
                    }
                    else if (Model.Estado == "EnMantencion")
                    {
                        <li>Completa la mantenciÃ³n activa</li>
                        <li>O cambia manualmente el estado a "Disponible"</li>
                        <li>Luego podrÃ¡s eliminarla</li>
                    }
                </ol>
            </div>
        }
    </div>
</div>

<div class="mt-3">
    @if (puedeEliminar)
    {
        <form asp-action="Delete" method="post" style="display:inline;">
            <input type="hidden" asp-for="Id" />
            <button type="submit" class="btn btn-warning" onclick="return confirm('Â¿EstÃ¡ seguro de desactivar esta camioneta?')">
                ğŸ”’ Confirmar DesactivaciÃ³n
            </button>
        </form>
    }
    else
    {
        <a asp-action="CambiarEstado" asp-route-id="@Model.Id" class="btn btn-warning">
            ğŸ”„ Cambiar Estado
        </a>
    }
    <a asp-action="Index" class="btn btn-secondary">Volver al Listado</a>
</div>